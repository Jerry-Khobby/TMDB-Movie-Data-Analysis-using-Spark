2026-01-26 08:49:47,628 | INFO | Logging initialized. Log file: /tmdbmovies/app/logs/tmdb_transform_20260126_084947.log
2026-01-26 08:49:48,029 | WARNING | Matplotlib created a temporary cache directory at /tmp/matplotlib-bh852rp8 because the default path (/home/spark/.config/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
2026-01-26 08:49:48,234 | INFO | generated new fontManager
2026-01-26 08:49:48,426 | INFO | Logging initialized | log_file=/tmdbmovies/app/logs/tmdb_main_20260126_084948.log
2026-01-26 08:49:48,427 | INFO | Starting TMDB Spark Pipeline
2026-01-26 08:49:49,925 | INFO | Extraction step started
2026-01-26 08:49:49,926 | INFO | Extracting movie_id=0
2026-01-26 08:49:50,177 | INFO | Extracting movie_id=299534
2026-01-26 08:49:51,258 | INFO | Extracting movie_id=19995
2026-01-26 08:49:51,683 | INFO | Extracting movie_id=140607
2026-01-26 08:49:52,088 | INFO | Extracting movie_id=299536
2026-01-26 08:49:52,508 | INFO | Extracting movie_id=597
2026-01-26 08:49:52,903 | INFO | Extracting movie_id=135397
2026-01-26 08:49:53,303 | INFO | Extracting movie_id=420818
2026-01-26 08:49:53,683 | INFO | Extracting movie_id=24428
2026-01-26 08:49:54,226 | INFO | Extracting movie_id=168259
2026-01-26 08:49:54,773 | INFO | Extracting movie_id=99861
2026-01-26 08:49:55,191 | INFO | Extracting movie_id=284054
2026-01-26 08:49:55,600 | INFO | Extracting movie_id=12445
2026-01-26 08:49:56,590 | INFO | Extracting movie_id=181808
2026-01-26 08:49:56,983 | INFO | Extracting movie_id=330457
2026-01-26 08:49:57,362 | INFO | Extracting movie_id=351286
2026-01-26 08:49:57,759 | INFO | Extracting movie_id=109445
2026-01-26 08:49:58,153 | INFO | Extracting movie_id=321612
2026-01-26 08:49:58,546 | INFO | Extracting movie_id=260513
2026-01-26 08:50:11,493 | INFO | Extraction completed | records=18
2026-01-26 08:50:11,502 | INFO | Transformation step started
2026-01-26 08:50:13,799 | INFO | Starting TMDB data cleaning pipeline
2026-01-26 08:50:13,801 | INFO | Dropping irrelevant columns
2026-01-26 08:50:13,847 | INFO | Extracting belongs_to_collection name
2026-01-26 08:50:13,928 | INFO | Flattening genres
2026-01-26 08:50:14,126 | INFO | Flattening spoken_languages
2026-01-26 08:50:14,183 | INFO | Flattening production_countries
2026-01-26 08:50:14,236 | INFO | Flattening production_companies
2026-01-26 08:50:14,276 | INFO | Casting numeric columns
2026-01-26 08:50:14,572 | INFO | Converting release_date to date
2026-01-26 08:50:14,668 | INFO | Replacing zero values with null
2026-01-26 08:50:14,906 | INFO | Converting budget and revenue to million USD
2026-01-26 08:50:14,981 | INFO | Handling vote_count = 0
2026-01-26 08:50:15,025 | INFO | Replacing placeholder text with null
2026-01-26 08:50:15,142 | INFO | Dropping duplicate movies
2026-01-26 08:50:15,157 | INFO | Dropping rows with missing id or title
2026-01-26 08:50:15,187 | INFO | Filtering rows with insufficient data
2026-01-26 08:50:15,271 | INFO | Filtering released movies
2026-01-26 08:50:15,350 | INFO | Extracting cast information
2026-01-26 08:50:15,446 | INFO | Extracting director
2026-01-26 08:50:15,574 | INFO | Reordering final columns
2026-01-26 08:50:15,669 | INFO | Resetting row index
2026-01-26 08:50:15,759 | INFO | Validation summary
2026-01-26 08:50:18,665 | INFO | Final row count: 18
2026-01-26 08:50:18,681 | INFO | Final column count: 22
2026-01-26 08:50:18,682 | INFO | TMDB data cleaning pipeline completed successfully
2026-01-26 08:50:18,687 | INFO | Saving cleaned DataFrame to CSV at /tmdbmovies/app/data/clean/tmdb_movies_clean.csv
2026-01-26 08:50:20,753 | INFO | CSV saved successfully as /tmdbmovies/app/data/clean/tmdb_movies_clean.csv
2026-01-26 08:50:20,769 | INFO | KPI computation started
2026-01-26 08:50:21,698 | INFO | TMDB KPI computation started
2026-01-26 08:50:21,700 | INFO | Top-N threshold set to 10
2026-01-26 08:50:22,017 | INFO | Input row count: 18
2026-01-26 08:50:22,028 | INFO | Input schema validation passed
2026-01-26 08:50:22,030 | INFO | Computing profit and ROI
2026-01-26 08:50:22,110 | INFO | Computing KPI: highest_revenue
2026-01-26 08:50:22,641 | INFO | highest_revenue | rank=1, title=Avatar, revenue_musd=2923.706026
2026-01-26 08:50:22,642 | INFO | highest_revenue | rank=2, title=Avengers: Endgame, revenue_musd=2799.4391
2026-01-26 08:50:22,643 | INFO | highest_revenue | rank=3, title=Titanic, revenue_musd=2264.162353
2026-01-26 08:50:22,644 | INFO | Computing KPI: highest_budget
2026-01-26 08:50:22,923 | INFO | highest_budget | rank=1, title=Avengers: Endgame, budget_musd=356.0
2026-01-26 08:50:22,924 | INFO | highest_budget | rank=2, title=Avengers: Infinity War, budget_musd=300.0
2026-01-26 08:50:22,925 | INFO | highest_budget | rank=3, title=Star Wars: The Last Jedi, budget_musd=300.0
2026-01-26 08:50:22,927 | INFO | Computing KPI: highest_profit
2026-01-26 08:50:23,479 | INFO | highest_profit | rank=1, title=Avatar, profit=2686.706026
2026-01-26 08:50:23,484 | INFO | highest_profit | rank=2, title=Avengers: Endgame, profit=2443.4391
2026-01-26 08:50:23,485 | INFO | highest_profit | rank=3, title=Titanic, profit=2064.162353
2026-01-26 08:50:23,487 | INFO | Computing KPI: lowest_profit
2026-01-26 08:50:23,773 | INFO | lowest_profit | rank=1, title=Star Wars: The Last Jedi, profit=1032.69883
2026-01-26 08:50:23,776 | INFO | lowest_profit | rank=2, title=Incredibles 2, profit=1043.225667
2026-01-26 08:50:23,777 | INFO | lowest_profit | rank=3, title=Beauty and the Beast, profit=1106.115964
2026-01-26 08:50:23,778 | INFO | Computing KPI: highest_roi
2026-01-26 08:50:24,124 | INFO | highest_roi | rank=1, title=Avatar, roi=12.33631234599156
2026-01-26 08:50:24,125 | INFO | highest_roi | rank=2, title=Titanic, roi=11.320811765
2026-01-26 08:50:24,127 | INFO | highest_roi | rank=3, title=Jurassic World, roi=11.14358296
2026-01-26 08:50:24,129 | INFO | Computing KPI: lowest_roi
2026-01-26 08:50:24,431 | INFO | lowest_roi | rank=1, title=Star Wars: The Last Jedi, roi=4.442329433333334
2026-01-26 08:50:24,435 | INFO | lowest_roi | rank=2, title=Avengers: Age of Ultron, roi=5.98044125106383
2026-01-26 08:50:24,437 | INFO | lowest_roi | rank=3, title=Incredibles 2, roi=6.216128335
2026-01-26 08:50:24,439 | INFO | Computing KPI: most_voted
2026-01-26 08:50:24,793 | INFO | most_voted | rank=1, title=The Avengers, vote_count=35391
2026-01-26 08:50:24,800 | INFO | most_voted | rank=2, title=Avatar, vote_count=33326
2026-01-26 08:50:24,812 | INFO | most_voted | rank=3, title=Avengers: Infinity War, vote_count=31385
2026-01-26 08:50:24,813 | INFO | Computing KPI: highest_rated
2026-01-26 08:50:25,226 | INFO | highest_rated | rank=1, title=Avengers: Infinity War, vote_average=8.235, vote_count=31385
2026-01-26 08:50:25,227 | INFO | highest_rated | rank=2, title=Avengers: Endgame, vote_average=8.2, vote_count=27170
2026-01-26 08:50:25,229 | INFO | highest_rated | rank=3, title=Harry Potter and the Deathly Hallows: Part 2, vote_average=8.081, vote_count=21608
2026-01-26 08:50:25,231 | INFO | Computing KPI: lowest_rated
2026-01-26 08:50:25,519 | INFO | lowest_rated | rank=1, title=Jurassic World: Fallen Kingdom, vote_average=6.535, vote_count=12507
2026-01-26 08:50:25,520 | INFO | lowest_rated | rank=2, title=Jurassic World, vote_average=6.7, vote_count=21254
2026-01-26 08:50:25,521 | INFO | lowest_rated | rank=3, title=Star Wars: The Last Jedi, vote_average=6.76, vote_count=16045
2026-01-26 08:50:25,522 | INFO | Computing KPI: most_popular
2026-01-26 08:50:25,827 | INFO | most_popular | rank=1, title=The Avengers, popularity=82.8271
2026-01-26 08:50:25,828 | INFO | most_popular | rank=2, title=Avatar, popularity=48.9819
2026-01-26 08:50:25,829 | INFO | most_popular | rank=3, title=Avengers: Infinity War, popularity=31.32
2026-01-26 08:50:25,830 | INFO | TMDB KPI computation completed successfully
2026-01-26 08:50:25,831 | INFO | Total KPI outputs generated: 10
2026-01-26 08:50:25,835 | INFO | Advanced TMDB KPI computation started
2026-01-26 08:50:26,004 | INFO | Top-N threshold: 10, Input rows: 18
2026-01-26 08:50:26,005 | INFO | Casting numeric columns to correct types for calculations
2026-01-26 08:50:26,107 | INFO | Casting complete
2026-01-26 08:50:26,108 | INFO | Calculating profit and ROI
2026-01-26 08:50:26,601 | INFO | highest_revenue | rank=1, title=Avatar, revenue_musd=2923.706026
2026-01-26 08:50:26,602 | INFO | highest_revenue | rank=2, title=Avengers: Endgame, revenue_musd=2799.4391
2026-01-26 08:50:26,603 | INFO | highest_revenue | rank=3, title=Titanic, revenue_musd=2264.162353
2026-01-26 08:50:26,848 | INFO | highest_budget | rank=1, title=Avengers: Endgame, budget_musd=356.0
2026-01-26 08:50:26,853 | INFO | highest_budget | rank=2, title=Avengers: Infinity War, budget_musd=300.0
2026-01-26 08:50:26,855 | INFO | highest_budget | rank=3, title=Star Wars: The Last Jedi, budget_musd=300.0
2026-01-26 08:50:27,092 | INFO | highest_profit | rank=1, title=Avatar, profit=2686.706026
2026-01-26 08:50:27,094 | INFO | highest_profit | rank=2, title=Avengers: Endgame, profit=2443.4391
2026-01-26 08:50:27,095 | INFO | highest_profit | rank=3, title=Titanic, profit=2064.162353
2026-01-26 08:50:27,304 | INFO | lowest_profit | rank=1, title=Star Wars: The Last Jedi, profit=1032.69883
2026-01-26 08:50:27,305 | INFO | lowest_profit | rank=2, title=Incredibles 2, profit=1043.225667
2026-01-26 08:50:27,306 | INFO | lowest_profit | rank=3, title=Beauty and the Beast, profit=1106.115964
2026-01-26 08:50:27,641 | INFO | highest_roi | rank=1, title=Avatar, roi=12.33631234599156
2026-01-26 08:50:27,644 | INFO | highest_roi | rank=2, title=Titanic, roi=11.320811765
2026-01-26 08:50:27,645 | INFO | highest_roi | rank=3, title=Jurassic World, roi=11.14358296
2026-01-26 08:50:27,911 | INFO | lowest_roi | rank=1, title=Star Wars: The Last Jedi, roi=4.442329433333334
2026-01-26 08:50:27,912 | INFO | lowest_roi | rank=2, title=Avengers: Age of Ultron, roi=5.98044125106383
2026-01-26 08:50:27,913 | INFO | lowest_roi | rank=3, title=Incredibles 2, roi=6.216128335
2026-01-26 08:50:28,108 | INFO | most_voted | rank=1, title=The Avengers, vote_count=35391
2026-01-26 08:50:28,109 | INFO | most_voted | rank=2, title=Avatar, vote_count=33326
2026-01-26 08:50:28,110 | INFO | most_voted | rank=3, title=Avengers: Infinity War, vote_count=31385
2026-01-26 08:50:28,424 | INFO | highest_rated | rank=1, title=Avengers: Infinity War, vote_average=8.235
2026-01-26 08:50:28,425 | INFO | highest_rated | rank=2, title=Avengers: Endgame, vote_average=8.2
2026-01-26 08:50:28,427 | INFO | highest_rated | rank=3, title=Harry Potter and the Deathly Hallows: Part 2, vote_average=8.081
2026-01-26 08:50:28,757 | INFO | lowest_rated | rank=1, title=Jurassic World: Fallen Kingdom, vote_average=6.535
2026-01-26 08:50:28,758 | INFO | lowest_rated | rank=2, title=Jurassic World, vote_average=6.7
2026-01-26 08:50:28,759 | INFO | lowest_rated | rank=3, title=Star Wars: The Last Jedi, vote_average=6.76
2026-01-26 08:50:28,975 | INFO | most_popular | rank=1, title=The Avengers, popularity=82.8271
2026-01-26 08:50:28,976 | INFO | most_popular | rank=2, title=Avatar, popularity=48.9819
2026-01-26 08:50:28,977 | INFO | most_popular | rank=3, title=Avengers: Infinity War, popularity=31.32
2026-01-26 08:50:28,978 | INFO | Running advanced search: Bruce Willis in Sci-Fi/Action movies
2026-01-26 08:50:29,268 | INFO | Running advanced search: Uma Thurman + Quentin Tarantino
2026-01-26 08:50:29,495 | INFO | Analyzing franchise vs standalone movies
2026-01-26 08:50:30,126 | INFO | Franchise vs Standalone | is_franchise=True, mean_revenue=1682.6684113749998, median_roi=7.708641394117647
2026-01-26 08:50:30,127 | INFO | Franchise vs Standalone | is_franchise=False, mean_revenue=1765.1391585000001, median_roi=7.913224775000001
2026-01-26 08:50:30,128 | INFO | Computing most successful franchises
2026-01-26 08:50:30,728 | INFO | Most Successful Franchises | belongs_to_collection=The Avengers Collection, total_revenue=7776.073348, mean_rating=7.913499999999999
2026-01-26 08:50:30,729 | INFO | Most Successful Franchises | belongs_to_collection=Star Wars Collection, total_revenue=3400.9224540000005, mean_rating=7.0065
2026-01-26 08:50:30,732 | INFO | Most Successful Franchises | belongs_to_collection=Jurassic Park Collection, total_revenue=2982.0064810000003, mean_rating=6.6175
2026-01-26 08:50:30,734 | INFO | Computing most successful directors
2026-01-26 08:50:31,210 | INFO | Most Successful Directors | director=James Cameron, total_revenue=5187.868379, mean_rating=7.7509999999999994
2026-01-26 08:50:31,213 | INFO | Most Successful Directors | director=Joss Whedon, total_revenue=2924.219209, mean_rating=7.6095
2026-01-26 08:50:31,216 | INFO | Most Successful Directors | director=Joe Russo, total_revenue=2799.4391, mean_rating=8.2
2026-01-26 08:50:31,220 | INFO | Advanced TMDB KPI computation completed
2026-01-26 08:50:55,250 | INFO | Computed 10 basic KPIs
2026-01-26 08:50:55,251 | INFO | Computed 15 advanced KPIs
2026-01-26 08:50:55,251 | INFO | Visualization started
2026-01-26 08:50:55,255 | INFO | Starting TMDB visualizations
2026-01-26 08:50:55,262 | INFO | Loaded DataFrame from /tmdbmovies/app/data/clean/tmdb_movies_clean.csv with 18 rows
2026-01-26 08:50:55,513 | INFO | Saved plot: /tmdbmovies/app/data/diagrams/revenue_vs_budget.png
2026-01-26 08:50:55,768 | INFO | Saved plot: /tmdbmovies/app/data/diagrams/roi_by_genre.png
2026-01-26 08:50:55,993 | INFO | Saved plot: /tmdbmovies/app/data/diagrams/top10_popular_movies.png
2026-01-26 08:50:56,160 | INFO | Saved plot: /tmdbmovies/app/data/diagrams/yearly_box_office.png
2026-01-26 08:50:56,315 | INFO | Saved plot: /tmdbmovies/app/data/diagrams/franchise_vs_standalone.png
2026-01-26 08:50:56,316 | INFO | All TMDB visualizations completed
2026-01-26 08:50:56,316 | INFO | TMDB Pipeline completed successfully
2026-01-26 08:50:56,975 | INFO | Spark session stopped
2026-01-26 08:50:56,994 | INFO | Closing down clientserver connection
